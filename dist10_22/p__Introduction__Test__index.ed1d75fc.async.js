"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[876],{82061:function($,R,l){var y=l(1413),d=l(67294),S=l(47046),v=l(91146),O=function(b,m){return d.createElement(v.Z,(0,y.Z)((0,y.Z)({},b),{},{ref:m,icon:S.Z}))},h=d.forwardRef(O);R.Z=h},39866:function($,R,l){l.r(R);var y=l(15009),d=l.n(y),S=l(99289),v=l.n(S),O=l(5574),h=l.n(O),I=l(6110),b=l(29966),m=l(67294),_=l(2453),M=l(17788),B=l(83622),F=l(82061),g=l(85893),z=function(){var J=(0,m.useRef)(),N=(0,m.useState)([]),j=h()(N,2),V=j[0],k=j[1],x=(0,m.useState)([]),K=h()(x,2),E=K[0],T=K[1],G=(0,m.useState)([]),L=h()(G,2),C=L[0],Z=L[1],P=localStorage.getItem("token"),U=function(){var o=v()(d()().mark(function u(){var n,t;return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,fetch("/api/introduction/getIntroducionExamination",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(P)}});case 3:if(n=s.sent,n.ok){s.next=6;break}throw new Error("\u7F51\u7EDC\u9519\u8BEF");case 6:return s.next=8,n.json();case 8:t=s.sent,Array.isArray(t.data)?T(t.data):T([]),s.next=16;break;case 12:s.prev=12,s.t0=s.catch(0),_.ZP.error("\u83B7\u53D6\u8003\u79CD\u8BB0\u5F55\u5931\u8D25"),T([]);case 16:case"end":return s.stop()}},u,null,[[0,12]])}));return function(){return o.apply(this,arguments)}}();(0,m.useEffect)(function(){U()},[]),(0,m.useEffect)(function(){localStorage.setItem("testRecords",JSON.stringify(E))},[E]);var Q=(0,m.useState)([]),W=h()(Q,2),H=W[0],w=W[1];(0,m.useEffect)(function(){w(E)},[E]);var X=function(u,n){var t=E,c=n.introductionTimeRange;if(c&&Array.isArray(c)){var s=h()(c,2),D=s[0],f=s[1];t=t.filter(function(a){var e=new Date(a.introductionTime).getTime();return e>=new Date(D).getTime()&&e<=new Date(f).getTime()})}var p=n.sowingTimeRange;if(p&&Array.isArray(p)){var r=h()(p,2),A=r[0],i=r[1];t=t.filter(function(a){var e=new Date(a.sowingTime).getTime();return e>=new Date(A).getTime()&&e<=new Date(i).getTime()})}n.plantingCode&&(t=t.filter(function(a){var e;return((e=a.plantingCode)!==null&&e!==void 0?e:"").toString().includes(n.plantingCode)})),n.code&&(t=t.filter(function(a){var e;return((e=a.code)!==null&&e!==void 0?e:"").toString().includes(n.code)})),n.name&&(t=t.filter(function(a){var e;return((e=a.name)!==null&&e!==void 0?e:"").toString().includes(n.name)})),n.method&&(t=t.filter(function(a){var e;return((e=a.method)!==null&&e!==void 0?e:"").toString().includes(n.method)})),n.type&&(t=t.filter(function(a){var e;return((e=a.type)!==null&&e!==void 0?e:"").toString().includes(n.type)})),n.isRegular&&(t=t.filter(function(a){var e;return((e=a.isRegular)!==null&&e!==void 0?e:"").toString().includes(n.isRegular)})),n.generation&&(t=t.filter(function(a){var e;return((e=a.generation)!==null&&e!==void 0?e:"").toString().includes(n.generation)})),n.sowingAmount&&(t=t.filter(function(a){var e;return String((e=a.sowingAmount)!==null&&e!==void 0?e:"").includes(n.sowingAmount)})),n.planCode&&(t=t.filter(function(a){var e;return((e=a.planCode)!==null&&e!==void 0?e:"").toString().includes(n.planCode)})),n.testTime&&(t=t.filter(function(a){var e;return((e=a.testTime)!==null&&e!==void 0?e:"").toString().includes(n.testTime)})),n.germinationRate&&(t=t.filter(function(a){var e;return String((e=a.germinationRate)!==null&&e!==void 0?e:"").includes(n.germinationRate)})),n.purityRate&&(t=t.filter(function(a){var e;return String((e=a.purityRate)!==null&&e!==void 0?e:"").includes(n.purityRate)})),n.remarks&&(t=t.filter(function(a){var e;return((e=a.remarks)!==null&&e!==void 0?e:"").toString().includes(n.remarks)})),w(t)},Y=function(){var o=v()(d()().mark(function u(n){return d()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:M.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u79CD\u690D\u7F16\u53F7\u4E3A ".concat(n.plantingCode," \u7684\u8BB0\u5F55\u5417\uFF1F"),onOk:function(){var s=v()(d()().mark(function f(){var p,r;return d()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,fetch("/api/introduction/examinationdelete?plantid=".concat(n.plantingCode),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(P)}});case 3:return p=i.sent,i.next=6,p.json();case 6:r=i.sent,r&&(r.success||r.code===200||r.msg==="SUCCESS")?(T(E.filter(function(a){return a.plantingCode!==n.plantingCode})),_.ZP.success("\u5220\u9664\u6210\u529F"),U()):_.ZP.error((r==null?void 0:r.msg)||"\u5220\u9664\u5931\u8D25"),i.next=13;break;case 10:i.prev=10,i.t0=i.catch(0),_.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 13:case"end":return i.stop()}},f,null,[[0,10]])}));function D(){return s.apply(this,arguments)}return D}()});case 1:case"end":return c.stop()}},u)}));return function(n){return o.apply(this,arguments)}}(),q=function(){var o=v()(d()().mark(function u(){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(C.length!==0){t.next=3;break}return _.ZP.warning("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u8BB0\u5F55"),t.abrupt("return");case 3:M.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684 ".concat(C.length," \u6761\u8BB0\u5F55\u5417\uFF1F"),onOk:function(){var c=v()(d()().mark(function D(){var f,p,r;return d()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,f=C,i.next=4,fetch("/api/introduction/BatchDeleteExamination",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(P)},body:JSON.stringify({keys:f})});case 4:return p=i.sent,i.next=7,p.json();case 7:r=i.sent,r&&(r.success||r.code===200||r.msg==="SUCCESS")?(T(E.filter(function(a){return!f.includes(a.plantingCode)})),Z([]),_.ZP.success("\u6279\u91CF\u5220\u9664\u6210\u529F")):_.ZP.error((r==null?void 0:r.msg)||"\u6279\u91CF\u5220\u9664\u5931\u8D25"),i.next=14;break;case 11:i.prev=11,i.t0=i.catch(0),_.ZP.error("\u6279\u91CF\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 14:case"end":return i.stop()}},D,null,[[0,11]])}));function s(){return c.apply(this,arguments)}return s}()});case 4:case"end":return t.stop()}},u)}));return function(){return o.apply(this,arguments)}}(),ee=[{title:"\u79CD\u690D\u7F16\u53F7",dataIndex:"plantingCode"},{title:"\u7F16\u53F7",dataIndex:"code"},{title:"\u54C1\u79CD\u540D\u79F0",dataIndex:"name"},{title:"\u5F15\u79CD\u65B9\u5F0F",dataIndex:"method"},{title:"\u54C1\u79CD\u7C7B\u578B",dataIndex:"type"},{title:"\u662F\u5426\u5E38\u89C4",dataIndex:"isRegular"},{title:"\u4E16\u4EE3",dataIndex:"generation"},{title:"\u64AD\u79CD\u6570\u91CF",dataIndex:"sowingAmount"},{title:"\u8BA1\u5212\u7F16\u53F7",dataIndex:"planCode"},{title:"\u5F15\u79CD\u65F6\u95F4",dataIndex:"introductionTime",valueType:"dateRange",editable:!1,search:{transform:function(u){return{introductionTimeRange:u}}},render:function(u,n){return n.introductionTime?new Date(n.introductionTime).toLocaleDateString():"-"}},{title:"\u64AD\u79CD\u65F6\u95F4",dataIndex:"sowingTime",valueType:"dateRange",editable:!1,search:{transform:function(u){return{sowingTimeRange:u}}},render:function(u,n){return n.sowingTime?(0,g.jsx)("span",{children:new Date(n.sowingTime).toLocaleString()}):(0,g.jsx)("span",{children:"-"})}},{title:"\u8003\u79CD\u65F6\u95F4",dataIndex:"testTime",render:function(u,n){return n.testTime?(0,g.jsx)("span",{children:new Date(n.testTime).toLocaleString()}):(0,g.jsx)("span",{children:"-"})},editable:!1},{title:"\u53D1\u82BD\u7387(%)",dataIndex:"germinationRate",valueType:"digit",editable:function(){return!0}},{title:"\u7EAF\u5EA6(%)",dataIndex:"purityRate",valueType:"digit",editable:function(){return!0}},{title:"\u5907\u6CE8",dataIndex:"remarks",editable:function(){return!0}},{title:"\u64CD\u4F5C",valueType:"option",render:function(u,n){return[(0,g.jsx)(B.ZP,{type:"link",onClick:function(){k([n.plantingCode])},children:"\u7F16\u8F91"},"edit"),(0,g.jsx)(B.ZP,{type:"link",danger:!0,onClick:function(){return Y(n)},children:"\u5220\u9664"},"delete")]}}];return(0,g.jsx)(I._z,{children:(0,g.jsx)(b.Z,{headerTitle:"\u8003\u79CD\u8BB0\u5F55",actionRef:J,rowKey:"plantingCode",search:{labelWidth:120},form:{onValuesChange:X},toolBarRender:function(){return[(0,g.jsx)(B.ZP,{danger:!0,icon:(0,g.jsx)(F.Z,{}),onClick:q,disabled:C.length===0,children:"\u6279\u91CF\u5220\u9664"},"batchDelete")]},rowSelection:{selectedRowKeys:C,onChange:function(u){return Z(u)}},dataSource:H,onReset:function(){return w(E)},editable:{type:"single",editableKeys:V,onChange:function(u){return k(u.map(String))},onSave:function(){var o=v()(d()().mark(function n(t,c){var s,D,f;return d()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,fetch("/api/introduction/examinationedit",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(P)},body:JSON.stringify(c)});case 3:if(s=r.sent,!s.ok){r.next=15;break}return _.ZP.success("\u4FDD\u5B58\u6210\u529F"),r.next=8,fetch("/api/introduction/getIntroducionExamination",{headers:{Authorization:"Bearer ".concat(P)}});case 8:return D=r.sent,r.next=11,D.json();case 11:f=r.sent,Array.isArray(f.data)&&T(f.data),r.next=16;break;case 15:_.ZP.error("\u4FDD\u5B58\u5931\u8D25");case 16:r.next=21;break;case 18:r.prev=18,r.t0=r.catch(0),_.ZP.error("\u4FDD\u5B58\u5931\u8D25");case 21:case"end":return r.stop()}},n,null,[[0,18]])}));function u(n,t){return o.apply(this,arguments)}return u}()},columns:ee,pagination:{showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],defaultPageSize:10,showTotal:function(u){return"\u5171 ".concat(u," \u6761\u8BB0\u5F55")}}})})};R.default=z}}]);
