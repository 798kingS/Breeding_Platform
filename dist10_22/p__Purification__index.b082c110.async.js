"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[5],{82061:function(U,g,a){var P=a(1413),v=a(67294),A=a(47046),_=a(91146),j=function(h,M){return v.createElement(_.Z,(0,P.Z)((0,P.Z)({},h),{},{ref:M,icon:A.Z}))},m=v.forwardRef(j);g.Z=m},69753:function(U,g,a){var P=a(1413),v=a(67294),A=a(49495),_=a(91146),j=function(h,M){return v.createElement(_.Z,(0,P.Z)((0,P.Z)({},h),{},{ref:M,icon:A.Z}))},m=v.forwardRef(j);g.Z=m},88484:function(U,g,a){a.d(g,{Z:function(){return h}});var P=a(1413),v=a(67294),A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},_=A,j=a(91146),m=function(E,L){return v.createElement(j.Z,(0,P.Z)((0,P.Z)({},E),{},{ref:L,icon:_}))},Z=v.forwardRef(m),h=Z},17794:function(U,g,a){a.r(g);var P=a(19632),v=a.n(P),A=a(15009),_=a.n(A),j=a(97857),m=a.n(j),Z=a(99289),h=a.n(Z),M=a(5574),E=a.n(M),L=a(6110),ae=a(29966),p=a(67294),ue=a(76772),C=a(8232),f=a(2453),R=a(17788),B=a(83622),te=a(40056),se=a(78367),b=a(55102),le=a(73320),ie=a(56063),k=a(88484),oe=a(82061),de=a(69753),ce=a(27484),I=a.n(ce),n=a(85893),_e=function(){var fe=(0,p.useRef)(),z=(0,ue.useLocation)(),me=(0,p.useState)([]),V=E()(me,2),O=V[0],F=V[1],he=(0,p.useState)([]),Y=E()(he,2),y=Y[0],$=Y[1],Ee=(0,p.useState)(!1),N=E()(Ee,2),De=N[0],w=N[1],ve=(0,p.useState)(null),J=E()(ve,2),G=J[0],pe=J[1],Ce=C.Z.useForm(),Pe=E()(Ce,1),S=Pe[0],ge=(0,p.useState)(!1),H=E()(ge,2),Be=H[0],K=H[1],Oe=(0,p.useState)(!1),Q=E()(Oe,2),X=Q[0],q=Q[1],T=localStorage.getItem("token");(0,p.useEffect)(function(){var s=function(){var r=h()(_()().mark(function u(){var i,l,o;return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/Selfing/getSelfingSeed",{headers:{Authorization:"Bearer ".concat(T)}});case 3:if(i=e.sent,i.ok){e.next=6;break}throw new Error("\u7F51\u7EDC\u9519\u8BEF");case 6:return e.next=8,i.json();case 8:l=e.sent,Array.isArray(l.data)?(o=l.data.map(function(c){var t,D;return m()(m()({},c),{},{key:(t=(D=c.id)!==null&&D!==void 0?D:c.key)!==null&&t!==void 0?t:Date.now()+Math.random()})}),F(o)):F([]),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),f.ZP.error("\u83B7\u53D6\u81EA\u4EA4\u7CFB\u7EAF\u5316\u6570\u636E\u5931\u8D25"),F([]);case 16:case"end":return e.stop()}},u,null,[[0,12]])}));return function(){return r.apply(this,arguments)}}();s()},[]),(0,p.useEffect)(function(){var s=z.state,r=s||{},u=r.purificationRecord;u&&!O.some(function(i){return i.key===u.key})&&F(function(i){return[].concat(v()(i),[u])})},[z.state]);var Fe=(0,p.useState)({}),ee=E()(Fe,2),x=ee[0],Ae=ee[1],je=(0,p.useState)([]),ne=E()(je,2),be=ne[0],re=ne[1];(0,p.useEffect)(function(){var s=O,r=x.introductionTimeRange;if(r&&Array.isArray(r)){var u=E()(r,2),i=u[0],l=u[1];s=s.filter(function(o){var d=I()(o.introductionTime).valueOf();return d>=I()(i).valueOf()&&d<=I()(l).valueOf()})}Object.entries(x).forEach(function(o){var d=E()(o,2),e=d[0],c=d[1];if(!(c==null||c===""))if(e==="sowingTime")typeof c=="string"&&(s=s.filter(function(t){return(t.sowingTime||"").includes(c)}));else{if(e==="introductionTimeRange")return;typeof c=="string"?s=s.filter(function(t){return(t[e]||"").toString().includes(c)}):s=s.filter(function(t){return t[e]===c})}}),re(s)},[O,x]);var Me=function(r){R.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u79CD\u690D\u7F16\u53F7\u4E3A ".concat(r.pedigreeNumber," \u7684\u8BB0\u5F55\u5417\uFF1F"),onOk:function(){var u=h()(_()().mark(function l(){var o,d,e;return _()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("/api/Selfing/seeddelete?plantid=".concat(r.pedigreeNumber),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(T)}});case 3:return o=t.sent,t.next=6,o.json();case 6:d=t.sent,o.ok&&d.success!==!1?(f.ZP.success("\u5220\u9664\u6210\u529F"),e=O.filter(function(D){return D.key!==r.key}),F(e)):f.ZP.error(d.message||"\u5220\u9664\u5931\u8D25"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),f.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 13:case"end":return t.stop()}},l,null,[[0,10]])}));function i(){return u.apply(this,arguments)}return i}()})},Ie=function(){if(y.length===0){f.ZP.warning("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u8BB0\u5F55");return}R.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684 ".concat(y.length," \u6761\u8BB0\u5F55\u5417\uFF1F"),onOk:function(){var r=h()(_()().mark(function i(){var l,o,d,e;return _()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,l=y.map(function(D){var W=O.find(function(we){return we.key===D});return W==null?void 0:W.pedigreeNumber}).filter(Boolean),t.next=4,fetch("/api/Selfing/BatchDeleteSeed",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(T)},body:JSON.stringify({keys:l})});case 4:return o=t.sent,t.next=7,o.json();case 7:d=t.sent,o.ok&&d.success!==!1?(f.ZP.success("\u6279\u91CF\u5220\u9664\u6210\u529F"),e=O.filter(function(D){return!y.includes(D.key)}),F(e),$([])):f.ZP.error(d.message||"\u6279\u91CF\u5220\u9664\u5931\u8D25"),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),f.ZP.error("\u6279\u91CF\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 14:case"end":return t.stop()}},i,null,[[0,11]])}));function u(){return r.apply(this,arguments)}return u}()})},ye=function(r){pe(r),S.setFieldsValue(m()(m()({},r),{},{sowingTime:r.sowingTime?I()(r.sowingTime):I()()})),w(!0)},Se=function(){var s=h()(_()().mark(function r(){var u,i,l,o;return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.validateFields();case 3:if(u=e.sent,G){e.next=7;break}return f.ZP.error("\u672A\u627E\u5230\u5F53\u524D\u8BB0\u5F55"),e.abrupt("return");case 7:return i=m()(m()(m()({},G),u),{},{sowingTime:u.sowingTime?u.sowingTime.format("YYYY-MM-DD"):""}),e.next=10,fetch("/api/Selfing/sow",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(T)},body:JSON.stringify(i)});case 10:return l=e.sent,e.next=13,l.json();case 13:o=e.sent,l.ok&&o.success!==!1?(f.ZP.success("\u64AD\u79CD\u6210\u529F"),w(!1),S.resetFields()):f.ZP.error(o.message||"\u64AD\u79CD\u5931\u8D25"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),f.ZP.error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25");case 20:case"end":return e.stop()}},r,null,[[0,17]])}));return function(){return s.apply(this,arguments)}}(),Te=function(){var s=h()(_()().mark(function r(u){var i,l,o;return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q(!0),e.prev=1,e.next=4,fetch("/api/Selfing/ExcelImport",{method:"POST",headers:{Authorization:"Bearer ".concat(T)},body:u});case 4:if(i=e.sent,i.ok){e.next=7;break}throw new Error("\u5BFC\u5165\u5931\u8D25");case 7:return e.next=9,i.json();case 9:l=e.sent,l&&Array.isArray(l.data)?(o=l.data.map(function(c){var t,D;return m()(m()({},c),{},{key:(t=(D=c.id)!==null&&D!==void 0?D:c.key)!==null&&t!==void 0?t:Date.now()+Math.random()})}),F(function(c){return[].concat(v()(c),v()(o))}),f.ZP.success("\u5BFC\u5165\u6210\u529F"),K(!1)):f.ZP.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u540E\u7AEF\u672A\u8FD4\u56DE\u6709\u6548\u6570\u636E"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.error("\u5BFC\u5165\u5931\u8D25:",e.t0),f.ZP.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u683C\u5F0F");case 17:return e.prev=17,q(!1),e.finish(17);case 20:case"end":return e.stop()}},r,null,[[1,13,17,20]])}));return function(u){return s.apply(this,arguments)}}(),Ze=function(){var s=h()(_()().mark(function r(u){var i,l,o;return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/Selfing/editSelfing",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(T)},body:JSON.stringify(u)});case 3:return i=e.sent,e.next=6,i.json();case 6:if(l=e.sent,!(i.ok&&l.success!==!1)){e.next=14;break}return o=O.map(function(c){return c.key===u.key?m()(m()({},c),u):c}),F(o),f.ZP.success("\u4FDD\u5B58\u6210\u529F"),e.abrupt("return",!0);case 14:return f.ZP.error(l.message||"\u4FDD\u5B58\u5931\u8D25"),e.abrupt("return",!1);case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(0),f.ZP.error("\u4FDD\u5B58\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),e.abrupt("return",!1);case 22:case"end":return e.stop()}},r,null,[[0,18]])}));return function(u){return s.apply(this,arguments)}}(),Re=[{title:"\u7CFB\u8C31\u7F16\u53F7",dataIndex:"pedigreeNumber",hideInTable:!1,hideInSearch:!1},{title:"\u7F16\u53F7",dataIndex:"code",hideInTable:!1,hideInSearch:!1},{title:"\u54C1\u79CD\u540D\u79F0",dataIndex:"name",hideInTable:!1,hideInSearch:!1},{title:"\u5F15\u79CD\u65B9\u5F0F",dataIndex:"method",hideInTable:!1,hideInSearch:!1},{title:"\u54C1\u79CD\u7C7B\u578B",dataIndex:"type",hideInTable:!1,hideInSearch:!1},{title:"\u662F\u5426\u5E38\u89C4",dataIndex:"isRegular",hideInTable:!1,hideInSearch:!1},{title:"\u4E16\u4EE3",dataIndex:"generation",hideInTable:!1,hideInSearch:!1},{title:"\u5F15\u79CD\u65F6\u95F4",dataIndex:"introductionTime",valueType:"dateRange",hideInTable:!1,hideInSearch:!1,editable:!1,search:{transform:function(r){return{introductionTimeRange:r}}},render:function(r,u){return u.introductionTime?I()(u.introductionTime).format("YYYY-MM-DD"):"-"}},{title:"\u64CD\u4F5C",valueType:"option",render:function(r,u,i,l){return[(0,n.jsx)("a",{onClick:function(){var d;return l==null||(d=l.startEditable)===null||d===void 0?void 0:d.call(l,u.key)},children:"\u7F16\u8F91"},"edit"),(0,n.jsx)(B.ZP,{type:"link",onClick:function(){return ye(u)},children:"\u64AD\u79CD"},"sowing"),(0,n.jsx)(B.ZP,{type:"link",danger:!0,onClick:function(){return Me(u)},children:"\u5220\u9664"},"delete")]}}];return(0,n.jsxs)(L._z,{children:[(0,n.jsx)(ae.Z,{headerTitle:"\u81EA\u4EA4\u7CFB\u7EAF\u5316",actionRef:fe,rowKey:"key",search:{labelWidth:120},form:{onValuesChange:function(r,u){return Ae(u)}},toolBarRender:function(){return[(0,n.jsx)(B.ZP,{icon:(0,n.jsx)(k.Z,{}),onClick:function(){return K(!0)},children:"\u5BFC\u5165Excel"},"import"),(0,n.jsx)(B.ZP,{danger:!0,icon:(0,n.jsx)(oe.Z,{}),onClick:Ie,disabled:y.length===0,children:"\u6279\u91CF\u5220\u9664"},"batchDelete")]},rowSelection:{selectedRowKeys:y,onChange:function(r){return $(r)}},dataSource:be,onReset:function(){return re(O)},columns:Re,editable:{type:"single",onSave:function(){var s=h()(_()().mark(function u(i,l){return _()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Ze(l));case 1:case"end":return d.stop()}},u)}));function r(u,i){return s.apply(this,arguments)}return r}()},pagination:{showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],defaultPageSize:10,showTotal:function(r){return"\u5171 ".concat(r," \u6761\u8BB0\u5F55")}}}),(0,n.jsxs)(R.Z,{title:"\u5BFC\u5165Excel\u6587\u4EF6",open:Be,onCancel:function(){return K(!1)},footer:null,width:500,children:[(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)(te.Z,{message:"\u5BFC\u5165\u8BF4\u660E",description:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:"1. \u8BF7\u786E\u4FDDExcel\u6587\u4EF6\u683C\u5F0F\u6B63\u786E\uFF0C\u5305\u542B\u4EE5\u4E0B\u5217\uFF1A"}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:"\u7CFB\u8C31\u7F16\u53F7"}),(0,n.jsx)("li",{children:"\u7F16\u53F7"}),(0,n.jsx)("li",{children:"\u54C1\u79CD\u540D\u79F0"}),(0,n.jsx)("li",{children:"\u5F15\u79CD\u65B9\u5F0F"}),(0,n.jsx)("li",{children:"\u54C1\u79CD\u7C7B\u578B"}),(0,n.jsx)("li",{children:"\u662F\u5426\u5E38\u89C4"}),(0,n.jsx)("li",{children:"\u4E16\u4EE3"}),(0,n.jsx)("li",{children:"\u5F15\u79CD\u65F6\u95F4"}),(0,n.jsx)("li",{children:"\u64AD\u79CD\u6570\u91CF"}),(0,n.jsx)("li",{children:"\u64AD\u79CD\u65F6\u95F4"})]}),(0,n.jsx)("p",{children:"2. \u5F15\u79CD\u65B9\u5F0F\u53EF\u9009\uFF1A\u8D2D\u4E70\u3001\u4EA4\u6362\u3001\u8D60\u9001\u3001\u5176\u4ED6"}),(0,n.jsx)("p",{children:"3. \u54C1\u79CD\u7C7B\u578B\u53EF\u9009\uFF1A\u897F\u74DC\u3001\u751C\u74DC\u3001\u5357\u74DC"}),(0,n.jsx)("p",{children:"4. \u662F\u5426\u5E38\u89C4\u53EF\u9009\uFF1A\u662F\u3001\u5426"}),(0,n.jsx)("p",{children:"5. \u65F6\u95F4\u683C\u5F0F\uFF1AYYYY-MM-DD"}),(0,n.jsx)("p",{children:"6. \u64AD\u79CD\u6570\u91CF\uFF1A\u5FC5\u987B\u4E3A\u6B63\u6574\u6570"})]}),type:"info",showIcon:!0,style:{marginBottom:16}}),(0,n.jsx)("div",{style:{textAlign:"center",marginBottom:16},children:(0,n.jsx)(B.ZP,{type:"link",icon:(0,n.jsx)(de.Z,{}),onClick:function(){var r=document.createElement("a");r.href="https://breed-1258140596.cos.ap-shanghai.myqcloud.com/Breeding%20Platform/%E8%87%AA%E4%BA%A4%E7%B3%BB%E7%BA%AF%E5%8C%96%E6%A8%A1%E5%9D%97-2.xlsx",r.download="https://breed-1258140596.cos.ap-shanghai.myqcloud.com/Breeding%20Platform/%E8%87%AA%E4%BA%A4%E7%B3%BB%E7%BA%AF%E5%8C%96%E6%A8%A1%E5%9D%97-2.xlsx",document.body.appendChild(r),r.click(),document.body.removeChild(r)},style:{fontSize:"16px"},children:"\u4E0B\u8F7DExcel\u6A21\u677F"})})]}),(0,n.jsx)(se.Z,{accept:".xlsx,.xls",showUploadList:!1,customRequest:function(r){var u=r.file,i=r.onSuccess,l=r.onError,o=new FormData;o.append("file",u),Te(o).then(function(){return i==null?void 0:i(null)}).catch(function(d){return l==null?void 0:l(d)})},children:(0,n.jsx)(B.ZP,{type:"primary",icon:(0,n.jsx)(k.Z,{}),loading:X,style:{width:"100%",height:"40px"},children:X?"\u5BFC\u5165\u4E2D...":"\u9009\u62E9\u6587\u4EF6\u5E76\u5BFC\u5165"})})]}),(0,n.jsx)(R.Z,{title:"\u64AD\u79CD",visible:De,onCancel:function(){w(!1),S.resetFields()},footer:[(0,n.jsx)(B.ZP,{onClick:function(){w(!1),S.resetFields()},children:"\u53D6\u6D88"},"cancel"),(0,n.jsx)(B.ZP,{type:"primary",onClick:Se,children:"\u64AD\u79CD"},"submit")],width:600,children:(0,n.jsxs)(C.Z,{form:S,layout:"vertical",initialValues:{sowingAmount:1},children:[(0,n.jsx)(C.Z.Item,{name:"code",label:"\u7CFB\u8C31\u7F16\u53F7",children:(0,n.jsx)(b.Z,{disabled:!0})}),(0,n.jsx)(C.Z.Item,{name:"code",label:"\u7F16\u53F7",children:(0,n.jsx)(b.Z,{disabled:!0})}),(0,n.jsx)(C.Z.Item,{name:"name",label:"\u54C1\u79CD\u540D\u79F0",children:(0,n.jsx)(b.Z,{disabled:!0})}),(0,n.jsx)(C.Z.Item,{name:"method",label:"\u5F15\u79CD\u65B9\u5F0F",children:(0,n.jsx)(b.Z,{disabled:!0})}),(0,n.jsx)(C.Z.Item,{name:"type",label:"\u54C1\u79CD\u7C7B\u578B",children:(0,n.jsx)(b.Z,{disabled:!0})}),(0,n.jsx)(C.Z.Item,{name:"isRegular",label:"\u662F\u5426\u5E38\u89C4",children:(0,n.jsx)(b.Z,{disabled:!0})}),(0,n.jsx)(C.Z.Item,{name:"generation",label:"\u4E16\u4EE3",children:(0,n.jsx)(b.Z,{disabled:!0})}),(0,n.jsx)(C.Z.Item,{name:"sowingAmount",label:"\u64AD\u79CD\u6570\u91CF",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u64AD\u79CD\u6570\u91CF"}],children:(0,n.jsx)(le.Z,{min:1,style:{width:"100%"}})}),(0,n.jsx)(C.Z.Item,{name:"sowingTime",label:"\u64AD\u79CD\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u64AD\u79CD\u65F6\u95F4"}],children:(0,n.jsx)(ie.default,{style:{width:"100%"}})})]})})]})};g.default=_e}}]);
