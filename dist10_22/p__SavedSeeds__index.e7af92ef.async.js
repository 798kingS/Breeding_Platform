"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[867],{82061:function(W,T,r){var g=r(1413),y=r(67294),R=r(47046),d=r(91146),B=function(p,I){return y.createElement(d.Z,(0,g.Z)((0,g.Z)({},p),{},{ref:I,icon:R.Z}))},v=y.forwardRef(B);T.Z=v},58638:function(W,T,r){r.d(T,{Z:function(){return p}});var g=r(1413),y=r(67294),R={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},d=R,B=r(91146),v=function(K,f){return y.createElement(B.Z,(0,g.Z)((0,g.Z)({},K),{},{ref:f,icon:d}))},j=y.forwardRef(v),p=j},86330:function(W,T,r){r.r(T);var g=r(19632),y=r.n(g),R=r(15009),d=r.n(R),B=r(99289),v=r.n(B),j=r(5574),p=r.n(j),I=r(6110),K=r(29966),f=r(2453),k=r(17788),Z=r(83622),N=r(78957),Y=r(82061),V=r(58638),O=r(67294),J=r(27484),M=r.n(J),h=r(85893),G=function(){var Q=(0,O.useState)([]),F=p()(Q,2),m=F[0],E=F[1],X=(0,O.useState)([]),x=p()(X,2),P=x[0],z=x[1],S=(0,O.useRef)(),q=(0,O.useState)([]),$=p()(q,2),ee=$[0],b=$[1],L=localStorage.getItem("token");(0,O.useEffect)(function(){var u=function(){var n=v()(d()().mark(function a(){var t,s;return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/seed/getReserve",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(L)}});case 3:if(t=e.sent,t.ok){e.next=6;break}throw new Error("\u7F51\u7EDC\u9519\u8BEF");case 6:return e.next=8,t.json();case 8:s=e.sent,Array.isArray(s.data)?E(s.data):E([]),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),f.ZP.error("\u83B7\u53D6\u7559\u79CD\u8BB0\u5F55\u5931\u8D25"),E([]);case 16:case"end":return e.stop()}},a,null,[[0,12]])}));return function(){return n.apply(this,arguments)}}();u()},[]),(0,O.useEffect)(function(){b(m)},[m]);var re=function(n,a){var t=m,s=a.introductionYearRange;if(s&&Array.isArray(s)){var l=p()(s,2),e=l[0],C=l[1];t=t.filter(function(o){return o.introductionYear>=e&&o.introductionYear<=C})}var c=a.reserveTimeRange;if(c&&Array.isArray(c)){var _=p()(c,2),i=_[0],U=_[1];t=t.filter(function(o){var D=M()(o.reserveTime);return D.isAfter(M()(i).subtract(1,"second"))&&D.isBefore(M()(U).add(1,"second"))})}Object.entries(a).forEach(function(o){var D=p()(o,2),A=D[0],H=D[1];H&&(A==="reserveTime"||A==="introductionYear"||A==="introductionYearRange"||A==="reserveTimeRange"||(t=t.filter(function(oe){var w;return((w=oe[A])!==null&&w!==void 0?w:"").toString().includes(H)})))}),b(t)},ne=[{label:"\u5E38\u89C4\u79CD",value:"regular"},{label:"\u7EAF\u5316",value:"purification"}],ae=function(){var u=v()(d()().mark(function n(a){return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:k.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u8BB0\u5F55\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var l=v()(d()().mark(function C(){var c,_,i;return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,fetch("/api/seed/reservedelete?plantid=".concat(a),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(L)}});case 3:return c=o.sent,o.next=6,c.json();case 6:_=o.sent,_&&(_.success||_.code===200||_.msg==="SUCCESS")?(i=m.filter(function(D){return D.key!==a}),E(i),localStorage.setItem("savedSeeds",JSON.stringify(i)),f.ZP.success("\u8BB0\u5F55\u5DF2\u5220\u9664")):f.ZP.error((_==null?void 0:_.msg)||"\u5220\u9664\u5931\u8D25"),o.next=13;break;case 10:o.prev=10,o.t0=o.catch(0),f.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 13:case"end":return o.stop()}},C,null,[[0,10]])}));function e(){return l.apply(this,arguments)}return e}()});case 1:case"end":return s.stop()}},n)}));return function(a){return u.apply(this,arguments)}}(),te=function(){var u=v()(d()().mark(function n(){return d()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(P.length!==0){t.next=3;break}return f.ZP.warning("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u8BB0\u5F55"),t.abrupt("return");case 3:k.Z.confirm({title:"\u786E\u8BA4\u6279\u91CF\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684 ".concat(P.length," \u6761\u8BB0\u5F55\u5417\uFF1F"),okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var s=v()(d()().mark(function e(){var C,c;return d()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,fetch("/api/seed/BatchDeleteReserve",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(L)},body:JSON.stringify({keys:P})});case 3:return C=i.sent,i.next=6,C.json();case 6:c=i.sent,c&&(c.success||c.code===200||c.msg==="SUCCESS")?(E(m.filter(function(U){return!P.includes(U.key)})),z([]),f.ZP.success("\u5DF2\u5220\u9664 ".concat(P.length," \u6761\u8BB0\u5F55"))):f.ZP.error((c==null?void 0:c.msg)||"\u6279\u91CF\u5220\u9664\u5931\u8D25"),i.next=13;break;case 10:i.prev=10,i.t0=i.catch(0),f.ZP.error("\u6279\u91CF\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 13:case"end":return i.stop()}},e,null,[[0,10]])}));function l(){return s.apply(this,arguments)}return l}()});case 4:case"end":return t.stop()}},n)}));return function(){return u.apply(this,arguments)}}(),se=[{title:"\u54C1\u79CD\u540D\u79F0",dataIndex:"varietyName",valueType:"text",hideInTable:!1,fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u54C1\u79CD\u540D\u79F0"}},{title:"\u7C7B\u578B",dataIndex:"type",valueType:"text",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u7C7B\u578B"}},{title:"\u7559\u79CD\u7F16\u53F7",dataIndex:"seedNumber",valueType:"text",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u7559\u79CD\u7F16\u53F7"}},{title:"\u5F15\u79CD\u5E74\u4EFD",dataIndex:"introductionYear",valueType:"dateYearRange",render:function(n,a){return a.introductionYear?a.introductionYear:"-"},fieldProps:{placeholder:"\u8BF7\u9009\u62E9\u5F15\u79CD\u5E74\u4EFD"},search:{transform:function(n){return{introductionYearRange:n}}}},{title:"\u6765\u6E90",dataIndex:"source",valueType:"text",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u6765\u6E90"}},{title:"\u5E38\u89C4\u79CD/\u7EAF\u5316",dataIndex:"breedingType",valueType:"select",valueEnum:ne.reduce(function(u,n){return u[n.value]={text:n.label},u},{}),fieldProps:{placeholder:"\u8BF7\u9009\u62E9"}},{title:"\u79CD\u690D\u5E74\u4EFD",dataIndex:"plantingYear",valueType:"text",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u79CD\u690D\u5E74\u4EFD"}},{title:"\u6297\u6027",dataIndex:"texture",valueType:"text",fieldProps:{placeholder:"\u8BF7\u8F93\u5165\u6297\u6027"}},{title:"\u7559\u79CD\u65F6\u95F4",dataIndex:"reserveTime",valueType:"dateTimeRange",render:function(n,a){return a.reserveTime?M()(a.reserveTime).format("YYYY-MM-DD HH:mm:ss"):"-"},fieldProps:{placeholder:"\u8BF7\u9009\u62E9\u7559\u79CD\u65F6\u95F4"},search:{transform:function(n){return{reserveTimeRange:n}}}},{title:"\u64CD\u4F5C",dataIndex:"operation",valueType:"option",render:function(n,a){return[(0,h.jsx)(Z.ZP,{type:"link",danger:!0,icon:(0,h.jsx)(Y.Z,{}),onClick:function(){return ae(a.key)},children:"\u5220\u9664"},"delete")]},hideInSearch:!0}],le=function(){if(m.length===0){f.ZP.warning("\u6682\u65E0\u7559\u79CD\u8BB0\u5F55");return}var n=["\u54C1\u79CD\u540D\u79F0","\u7C7B\u578B","\u7559\u79CD\u7F16\u53F7","\u5F15\u79CD\u5E74\u4EFD","\u6765\u6E90","\u5E38\u89C4\u79CD/\u7EAF\u5316","\u79CD\u690D\u5E74\u4EFD","\u6297\u6027","\u7ED3\u679C\u7279\u5F81","\u5F00\u82B1\u671F/\u679C\u5B9E\u53D1\u80B2\u671F","\u7559\u679C\u4E2A\u6570","\u4EA7\u91CF","\u679C\u578B","\u76AE\u8272","\u8089\u8272","\u5355\u679C\u91CD(g)","\u8089\u539A(mm)","\u7CD6\u5EA6(\xB0Brix)","\u8D28\u5730","\u603B\u4F53\u53E3\u611F","\u914D\u5408\u529B","\u7559\u79CD\u65F6\u95F4"],a=[n.join(",")].concat(y()(m.map(function(e){return[e.varietyName||"",e.type||"",e.seedNumber||"",e.introductionYear||"",e.source||"",e.breedingType||"",e.plantingYear||"",e.resistance||"",e.fruitCharacteristics||"",e.floweringPeriod||"",e.fruitCount||"",e.yield||"",e.fruitShape||"",e.skinColor||"",e.fleshColor||"",e.singleFruitWeight||"",e.fleshThickness||"",e.sugarContent||"",e.texture||"",e.overallTaste||"",e.combiningAbility||"",e.reserveTime?"	"+M()(e.reserveTime).format("YYYY-MM-DD HH:mm:ss"):""].join(",")}))).join(`
`),t=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),l=URL.createObjectURL(t);s.setAttribute("href",l),s.setAttribute("download","\u7559\u79CD\u8BB0\u5F55.csv"),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)},ue=function(){var u=v()(d()().mark(function n(){var a,t;return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,fetch("/api/seed/getReserve",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(L)}});case 3:if(a=l.sent,a.ok){l.next=6;break}throw new Error("\u7F51\u7EDC\u9519\u8BEF");case 6:return l.next=8,a.json();case 8:t=l.sent,Array.isArray(t.data)?(E(t.data),b(t.data)):(E([]),b([])),l.next=16;break;case 12:l.prev=12,l.t0=l.catch(0),E([]),b([]);case 16:S.current&&S.current.reset&&S.current.reset();case 17:case"end":return l.stop()}},n,null,[[0,12]])}));return function(){return u.apply(this,arguments)}}();return(0,h.jsx)(I._z,{header:{title:"\u7559\u79CD\u8BB0\u5F55",extra:[(0,h.jsxs)(N.Z,{children:[(0,h.jsx)(Z.ZP,{type:"primary",icon:(0,h.jsx)(V.Z,{}),onClick:le,children:"\u5BFC\u51FA\u8BB0\u5F55"}),P.length>0&&(0,h.jsxs)(Z.ZP,{danger:!0,icon:(0,h.jsx)(Y.Z,{}),onClick:te,children:["\u6279\u91CF\u5220\u9664 (",P.length,")"]})]},"actions")]},children:(0,h.jsx)(K.Z,{actionRef:S,rowKey:"key",columns:se,dataSource:ee,onReset:function(){return b(m)},search:{labelWidth:90,defaultCollapsed:!0,collapseRender:function(n){return n?"\u5C55\u5F00 \u2228":"\u6536\u8D77 \u2227"},filterType:"query",resetText:"\u91CD\u7F6E"},form:{syncToUrl:!1,onValuesChange:function(n,a){var t=Object.values(a).every(function(s){return!s||Array.isArray(s)&&s.length===0});t?ue():re(n,a)}},toolBarRender:!1,rowSelection:{selectedRowKeys:P,onChange:z},pagination:{defaultPageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:function(n){return"\u5171 ".concat(n," \u6761\u8BB0\u5F55")}},options:!1,scroll:{x:1200}})})};T.default=G}}]);
